---
layout: post
title: Java Double Quiz - vyhodnocení, aneb cesta do hlouby čísel
date: '2011-02-02T22:13:00.001+01:00'
author: Libor Kramoliš
tags:
- double
- results
- quiz
- java
modified_time: '2011-03-10T21:45:40.603+01:00'
blogger_id: tag:blogger.com,1999:blog-2759548145050416517.post-7903155424712742675
---

V lednu jsem zveřejnil svůj <a href="http://yatel.kramolis.cz/2011/01/java-double-quiz.html"><b>Java Double Quiz</b></a>. Zde naleznete výsledky hlasování a správné odpovědi společně s vysvětlením. Pokud jste ještě nehlasovali, tak nepředbíhejte, jsou to jen 3 jednoduché otázky. ;-)<br /><br />Začneme statistikami. Jsem poctěn, že se k dnešnímu dni (14.2.2011) zapojilo 375 lidí s následujícími výsledky.<br /><table border="0" width="90%"><tr> <td><br /><table border="1" cellspacing="0" cellpadding="4"><caption>Podle jednotlivých otázek:</caption><tr> <th>Otázka<br />č.</th> <th>#<br />správných</th> <th>%<br />správných</th> </tr><tr> <td>1</td> <td>68</td> <td>18.13%</td> </tr><tr> <td>2</td> <td>84</td> <td>22.40%</td> </tr><tr> <td>3</td> <td>65</td> <td>17.33%</td> </tr></table></td> <td><br /><table border="1" cellspacing="0" cellpadding="4"><caption>Podle počtu správných odpovědí:</caption><tr> <th>#<br />správných</th> <th>#<br />odpovědí</th> <th>%<br />odpovědí</th> </tr><tr> <td>1</td> <td>106</td> <td>28.27%</td> </tr><tr> <td>2</td> <td>36</td> <td>9.60%</td> </tr><tr> <td>3</td> <td>13</td> <td>3.47%</td> </tr></table></td> </tr></table><br />Tedy 220 netrefilo ani jednu správnou odpověď, což je 58.67% a to je docela hodně. Upřímně, je to plus pro mě, protože se mi podařilo sestavit dostatečně manipulativní test. :-p<br /><br />A jaké jsou ty správné odpovědi? Čtěte dál.<br /><br /><br /><h4>1. Double MIN_VALUE</h4><br />U celočíselných datových typů (<code>byte</code>, <code>short</code>, <code>integer</code>, <code>long</code>) konstanta <code>MIN_VALUE</code> nabývá hodnot nejmenšího možného čísla daného typu (tedy záporné číslo):<br /><br /><table border="1" cellspacing="0" cellpadding="4"><caption>Celočíselné datové typy: MIN_VALUE a jako bonus i MAX_VALUE:</caption><tr>  <th>typ</th> <th>MIN_VALUE</th> <th>MAX_VALUE</th> </tr><tr>  <td><code>byte</code></td>  <td><code>-128 (-2<sup>7</sup>)</code></td>  <td><code>127 (2<sup>7</sup>-1)</code></td> </tr><tr>  <td><code>short</code></td>  <td><code>-32768 (-2<sup>15</sup>)</code></td>  <td><code>32767 (2<sup>15</sup>-1)</code></td> </tr><tr>  <td><code>integer</code></td>  <td><code>-2147483648 (-2<sup>31</sup>)</code></td>  <td><code>2147483647 (2<sup>31</sup>-1)</code></td> </tr><tr>  <td><code>long</code></td>  <td><code>-9223372036854775808 (-2<sup>63</sup>)</code></td>  <td><code>9223372036854775807 (2<sup>63</sup>-1)</code></td> </tr></table><br />V případě <code>float</code> a <code>double</code> je ale konstanta <code>MIN_VALUE</code> nejmenší možné kladné reálné číslo, které je možné v daném datovém typu vyjádřit:<br /><br /><table border="1" cellspacing="0" cellpadding="4"><caption>Reálné datové typy: MIN_VALUE a jejich javadoc</caption><tr>  <th>typ</th> <th>MIN_VALUE</th> <th>javadoc</th> </tr><tr>  <td><code>float</code></td>  <td><code>0x0.000002P-126f</code></td>  <td>A constant holding the smallest positive nonzero value of type <code>float</code>, 2<sup>-149</sup>. It is equal to the hexadecimal floating-point literal <code>0x0.000002P-126f</code> and also equal to <code>Float.intBitsToFloat(0x1)</code>.</td> </tr><tr>  <td><code>double</code></td>  <td><code>0x0.0000000000001P-1022</code></td>  <td>A constant holding the smallest positive nonzero value of type <code>double</code>, 2<sup>-1074</sup>. It is equal to the hexadecimal floating-point literal <code>0x0.0000000000001P-1022</code> and also equal to <code>Double.longBitsToDouble(0x1L)</code>.</td> </tr></table><br />Všimněte si metody <a href="http://download.oracle.com/javase/6/docs/api/java/lang/Double.html#longBitsToDouble%28long%29"><code>Double.<strong>longBitsToDouble</strong>(long)</code></a>, ta nám pomůže některé aspekty reálných čísel osvětlit. Tato metoda vrací <code>double</code>, který odpovídá bitům v <code>long</code>u. Symetricky, metoda <a href="http://download.oracle.com/javase/6/docs/api/java/lang/Double.html#doubleToRawLongBits%28double%29"><code>Double.<strong>doubleToRawLongBits</strong>(double)</code></a> vrací bity (<code>long</code>em) pro daný <code>double</code>.<br /><br /><pre class="brush:java">//nejmenší možný kladný double odpovídá binární jedničce:<br />assert  Double.MIN_VALUE == Double.longBitsToDouble(0x0000000000000001L);<br />//největší možné záporné číslo je Double.MIN_VALUE se záporným znaménkem:<br />assert -Double.MIN_VALUE == Double.longBitsToDouble(0x8000000000000001L);<br /></pre><br />A toto je vlastně klíč k záporné nule.<br /><pre class="brush:java">nejdříve "normální" nula:<br />assert  0.0d == Double.longBitsToDouble(0x0000000000000000L);<br />//a záporná nula:<br />assert -0.0d == Double.longBitsToDouble(0x8000000000000000L);<br /></pre><br />Malá hra s porovnáním binární podoby obou nul:<br /><pre class="brush:java">//double se rovná:<br />assert -0.0d == 0.0d;<br />//ale binárně už se nerovná<br />assert Double.doubleToRawLongBits(-0.0d)<br />    != Double.doubleToRawLongBits( 0.0d);<br /></pre><br />A ještě zjistění, že binarní zápis celých a reálných čísel se liší.<br /><br /><table border="1" cellspacing="0" cellpadding="4"><caption>"Nesymetrické" rozložení typu <code>Long</code></caption><tr> <th align="right">Long.MIN_VALUE</th> <td><code>8000000000000000</code></td> <th align="right">0</th><td><code>0000000000000000</code></td> </tr><tr> <th align="right">Long.MIN_VALUE+1</th> <td><code>8000000000000001</code></td> <th align="right">1</th><td><code>0000000000000001</code></td> </tr><tr> <th align="right">Long.MIN_VALUE+16</th> <td><code>8000000000000010</code></td> <th align="right">16</th><td><code>0000000000000010</code></td> </tr><tr> <th align="right">-16</th> <td><code>fffffffffffffff0</code></td> <th align="right">Long.MAX_VALUE-15</th><td><code>7ffffffffffffff0</code></td> </tr><tr> <th align="right">-2</th> <td><code>fffffffffffffffe</code></td> <th align="right">Long.MAX_VALUE-1</th><td><code>7ffffffffffffffe</code></td> </tr><tr> <th align="right">-1</th> <td><code>ffffffffffffffff</code></td> <th align="right">Long.MAX_VALUE</th><td><code>7fffffffffffffff</code></td> </tr></table><br /><table border="1" cellspacing="0" cellpadding="4"><caption>"Křišťálově čisté" rozložení typu <code>Double</code></caption> <tr> <th align="right">-Double.MAX_VALUE</th> <td><code>ffefffffffffffff</code></td> <th align="right">Double.MAX_VALUE</th><td><code>7fefffffffffffff</code></td> </tr> <tr> <th align="right">-Double.MIN_VALUE</th> <td><code>8000000000000001</code></td> <th align="right">Double.MIN_VALUE</th><td><code>0000000000000001</code></td> </tr> <tr> <th align="right">-0.0d</th> <td><code>8000000000000000</code></td> <th align="right">0.0d</th><td><code>0000000000000000</code></td> </tr> <tr> <th align="right">-123456789.987654321</th> <td><code>c19d6f3457f35ba8</code></td> <th align="right">123456789.987654321</th><td><code>419d6f3457f35ba8</code></td> </tr> <tr> <th align="right">-5.626349274901198E-221</th> <td><code>923456789abcdef0</code></td> <th align="right">5.626349274901198E-221</th><td><code>123456789abcdef0</code></td> </tr></table>"Slyšiš ten rozdíl? Slyšiš ten rozdíl?"<br /><br /><br />TODO: porovnat jak jsou binarne reseny cely a realny cisla<br /><br /><br /><strong class="lkr-important">Tedy u první otázky byla správná třetí možnost:</strong><br /><pre class="brush:java">Double.MIN_VALUE > 0.0d   // nejmenší "skutečný" klaďas<br /></pre>(Konstanta <code>Double.MIN_VALUE</code> je 1 bit nad nulou.)<br /><br /><br /><h4>2. Double INFINITY</h4><br /><table border="1" cellspacing="0" cellpadding="4"><caption>TODO</caption> <tr> <th align="right">???</th> <td><code>fff0000000000000</code></td> <th align="right">???</th><td><code>7ff0000000000000</code></td> </tr></table><br /><br /><strong class="lkr-important">Tedy u druhé otázky byla správná druhá možnost:</strong><br /><pre class="brush:java">true   // nekonečno od nekonečna pojde<br /></pre>(Konstanta <code>Double.MAX_VALUE</code> je 1 bit pod nekonečnem.)<br /><br /><br /><h4>3. Double Not-a-Number</h4><br /><br /><table border="1" cellspacing="0" cellpadding="4"><caption>TODO</caption> <tr> <th align="right">???</th> <td><code>fff0000000000001</code></td> <th align="right">???</th><td><code>7ff0000000000001</code></td> </tr> <tr> <th align="right">???</th> <td><code>fff000000000000f</code></td> <th align="right">???</th><td><code>7ff000000000000f</code></td> </tr> <tr> <th align="right">???</th> <td><code>ffff000000000000</code></td> <th align="right">???</th><td><code>7fff000000000000</code></td> </tr></table><br /><strong class="lkr-important">Tedy u třetí otázky byla správná třetí možnost:</strong><br /><pre class="brush:java">false   // instance ne-čísel se nerovnají<br /></pre><br /><br /><br /><h4>Katarze</h4><br />Neřeknu vám, proč máme v Java u <code>double</code> a <code>float</code> nekonečna a ne-číslo, a proč konstanta <code>MIN_VALUE</code> nabývá z mého pohledu špatnou hodnotu. Mohu vás ale uklidnit, celočíselné datové typy (<code>int</code>, <code>long</code>, atd.) fungují dle očekávání a v kvízu by šlo vždy o intuitivní první odpovědi: <code>MIN_VALUE &lt; 0</code> a 2x <code>ArithmeticException</code>.<br /><br />Doufám, že vás tento kvíz pobavil a žertovnou formou vám odhalil obvykle hledané 3 rozdíly ... a že si příště dáte sakra pozor, než budete pracovat s reálnými čísly. ;-)<br /><br />Závěrem se pokusím o jednu předpověď, která nemá šanci na přežití: "<cite>celá čísla musí stačit každému!</cite>"<br /><br />Libor<br /><br />PS: Ještě jednou díky za hlasování, takový zájem jsem vážně nečekal.